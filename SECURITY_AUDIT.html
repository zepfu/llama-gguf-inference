

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Security Audit Report — llama-gguf-inference v1 &mdash; llama-gguf-inference 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=9edc463e" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=8d563738"></script>
      <script src="_static/doctools.js?v=fd6eb6e6"></script>
      <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            llama-gguf-inference
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guides:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="API_REFERENCE.html">API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="API_REFERENCE.html#public-endpoints">Public Endpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="API_REFERENCE.html#get-ping">GET /ping</a></li>
<li class="toctree-l3"><a class="reference internal" href="API_REFERENCE.html#get-health">GET /health</a></li>
<li class="toctree-l3"><a class="reference internal" href="API_REFERENCE.html#get-metrics">GET /metrics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="API_REFERENCE.html#json-format-default">JSON format (default)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="AUTHENTICATION.html">Authentication Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#quick-start">Quick Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#create-api-keys-file">1. Create API Keys File</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#enable-authentication">2. Enable Authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#make-authenticated-requests">3. Make Authenticated Requests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#keys-file-format">Keys File Format</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#key-management">Key Management</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#key-management-cli">Key Management CLI</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#manual-key-generation">Manual Key Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#add-new-key-manual">Add New Key (Manual)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#rotate-key-manual">Rotate Key (Manual)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#revoke-key">Revoke Key</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#endpoint-access">Endpoint Access</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#public-endpoints-no-auth-required">Public Endpoints (No Auth Required)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#protected-endpoints-auth-required">Protected Endpoints (Auth Required)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#authentication-flow">Authentication Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#error-responses">Error Responses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#unauthorized">401 Unauthorized</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#rate-limit-exceeded">429 Rate Limit Exceeded</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#rate-limiting">Rate Limiting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#per-key-rate-limits">Per-Key Rate Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#key-expiration">Key Expiration</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#hot-reload-api-keys">Hot-Reload API Keys</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#access-logging">Access Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#metrics">Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#deployment-scenarios">Deployment Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#local-development-auth-disabled">Local Development (Auth Disabled)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#local-development-auth-enabled">Local Development (Auth Enabled)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#production-secure">Production (Secure)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#runpod-serverless">RunPod Serverless</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#security-best-practices">Security Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#file-security">File Security</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#key-generation">Key Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#key-storage">Key Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#key-rotation">Key Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#access-control">Access Control</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#troubleshooting">Troubleshooting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#auth-not-working-all-requests-accepted">Auth Not Working (All Requests Accepted)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#valid-key-rejected-401">Valid Key Rejected (401)</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#rate-limit-issues">Rate Limit Issues</a></li>
<li class="toctree-l3"><a class="reference internal" href="AUTHENTICATION.html#access-logs-not-written">Access Logs Not Written</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="AUTHENTICATION.html#future-enhancements">Future Enhancements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CONFIGURATION.html">Configuration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#environment-variables">Environment Variables</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#authentication-configuration">Authentication Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#hot-reload-api-keys">Hot-Reload API Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#cors-configuration">CORS Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#request-timeouts">Request Timeouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#concurrency-control">Concurrency Control</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#security-limits">Security Limits</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#data-directory">Data Directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#model-configuration">Model Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#server-configuration">Server Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#inference-configuration">Inference Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#logging-configuration">Logging Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#debug-configuration">Debug Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#recommended-configurations">Recommended Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#rtx-4090-24gb">RTX 4090 (24GB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#a100-40gb">A100 (40GB)</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#a100-80gb-h100">A100 (80GB) / H100</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#cpu-only">CPU Only</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#multi-worker-deployment">Multi-Worker Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#memory-estimation">Memory Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#environment-variable-precedence">Environment Variable Precedence</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#validation">Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#complete-example-configurations">Complete Example Configurations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#local-development">Local Development</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#production-runpod-serverless">Production (RunPod Serverless)</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#multi-model-platform">Multi-Model Platform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#security-best-practices">Security Best Practices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#api-keys">API Keys</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#network-security">Network Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#troubleshooting-configuration">Troubleshooting Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#check-current-configuration">Check Current Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="CONFIGURATION.html#common-issues">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="CONFIGURATION.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="DEPLOYMENT.html">Deployment Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#runpod-serverless">RunPod Serverless</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#prerequisites">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#quick-start">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#scale-to-zero-behavior">Scale-to-Zero Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#api-key-setup">API Key Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#testing">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#health-check-verification">Health Check Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#common-issues">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#runpod-pods">RunPod Pods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id1">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id2">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id3">Health Check Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id4">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#vast-ai">Vast.ai</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id5">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id6">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id7">Health Check Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id8">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#lambda-labs">Lambda Labs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id9">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id10">Quick Start</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id11">Health Check Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id12">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#local-docker-docker-compose">Local Docker / docker-compose</a><ul>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id13">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#quick-start-gpu">Quick Start (GPU)</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#quick-start-cpu">Quick Start (CPU)</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#using-docker-compose">Using docker-compose</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#environment-variables">Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#gpu-passthrough">GPU Passthrough</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#volume-mounts">Volume Mounts</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id14">Testing</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id15">Health Check Verification</a></li>
<li class="toctree-l3"><a class="reference internal" href="DEPLOYMENT.html#id16">Common Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#memory-estimation">Memory Estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="DEPLOYMENT.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MIGRATION.html">Migration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MIGRATION.html#migrating-from-pre-v1-0-0-to-v1-0-0">Migrating from pre-v1.0.0 to v1.0.0</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#environment-variable-changes">Environment Variable Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#new-features-requiring-configuration">New Features Requiring Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#cors-support">CORS Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#concurrency-control">Concurrency Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#api-key-management-cli">API Key Management CLI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#docker-image-tag-structure">Docker Image Tag Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#authentication-changes">Authentication Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#health-endpoint-changes">Health Endpoint Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="MIGRATION.html#post-rc-1-features">Post-rc.1 Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#per-key-rate-limits">Per-Key Rate Limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#key-expiration-ttl">Key Expiration / TTL</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#hot-reload-api-keys">Hot-Reload API Keys</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#structured-json-logging">Structured JSON Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#configurable-timeouts">Configurable Timeouts</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#non-root-container">Non-Root Container</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#new-security-limits">New Security Limits</a></li>
<li class="toctree-l4"><a class="reference internal" href="MIGRATION.html#new-http-responses">New HTTP Responses</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MIGRATION.html#breaking-changes-checklist">Breaking Changes Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="MIGRATION.html#new-environment-variables-reference">New Environment Variables Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="MIGRATION.html#see-also">See Also</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TESTING.html">Testing Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#current-test-coverage">Current Test Coverage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#pytest-test-suite">pytest Test Suite</a><ul>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-auth-py"><code class="docutils literal notranslate"><span class="pre">test_auth.py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-gateway-py"><code class="docutils literal notranslate"><span class="pre">test_gateway.py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-key-mgmt-py"><code class="docutils literal notranslate"><span class="pre">test_key_mgmt.py</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-benchmark-py"><code class="docutils literal notranslate"><span class="pre">test_benchmark.py</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#shell-tests-pre-commit">Shell Tests (Pre-commit)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-auth-sh"><code class="docutils literal notranslate"><span class="pre">test_auth.sh</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-health-sh"><code class="docutils literal notranslate"><span class="pre">test_health.sh</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#full-tests-github-actions">Full Tests (GitHub Actions)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#running-tests">Running Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#manual-testing">Manual Testing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-authentication">Test Authentication</a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-rate-limiting">Test Rate Limiting</a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-logging">Test Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-worker-type-logging">Test Worker Type Logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="TESTING.html#test-port-naming">Test Port Naming</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#planned-improvements">Planned Improvements</a></li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#debugging-failed-tests">Debugging Failed Tests</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#view-test-logs">View Test Logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#run-individual-test">Run Individual Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="TESTING.html#debug-auth-issues">Debug Auth Issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#contributing-tests">Contributing Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#test-checklist">Test Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="TESTING.html#resources">Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TROUBLESHOOTING.html">Troubleshooting Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#quick-diagnostics">Quick Diagnostics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#check-boot-logs">Check boot logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#check-server-logs">Check server logs</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#enable-debug-mode">Enable debug mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#common-issues">Common Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#model-not-found">Model Not Found</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#out-of-memory-oom">Out of Memory (OOM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#server-exits-immediately">Server Exits Immediately</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#gpu-not-detected">GPU Not Detected</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#health-check-failing">Health Check Failing</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#streaming-not-working">Streaming Not Working</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#slow-inference">Slow Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#data-dir-not-found">DATA_DIR Not Found</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#log-locations">Log Locations</a></li>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#platform-specific-issues">Platform-Specific Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#runpod-serverless">RunPod Serverless</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#vast-ai">Vast.ai</a></li>
<li class="toctree-l3"><a class="reference internal" href="TROUBLESHOOTING.html#local-docker">Local Docker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#getting-help">Getting Help</a></li>
<li class="toctree-l2"><a class="reference internal" href="TROUBLESHOOTING.html#reporting-issues">Reporting Issues</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Auto-Generated:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="auto/CHANGELOG.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="auto/CHANGELOG.html#unreleased">Unreleased</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#added">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#changed">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#security">Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/CHANGELOG.html#rc-1-2026-02-13">1.0.0-rc.1 - 2026-02-13</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#id1">Added</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#id2">Changed</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#fixed">Fixed</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/CHANGELOG.html#id3">Security</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html">Architecture (Auto-Generated)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#detected-patterns">Detected Patterns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#flowchart-diagram">Flowchart Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#state-diagram">State Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#sequence-diagram">Sequence Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#architecture-diagram">Architecture Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#er-diagram">Er Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#class-diagram">Class Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#journey-diagram">Journey Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#mindmap-diagram">Mindmap Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#workflow-pipeline-diagram">Workflow Pipeline Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#workflow-triggers-diagram">Workflow Triggers Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#workflow-jobs-diagram">Workflow Jobs Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#development-workflows">Development Workflows</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#github-workflows-summary">GitHub Workflows Summary</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#module-summary">Module Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#docs-conf"><code class="docutils literal notranslate"><span class="pre">docs.conf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#scripts-auth"><code class="docutils literal notranslate"><span class="pre">scripts.auth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#scripts-gateway"><code class="docutils literal notranslate"><span class="pre">scripts.gateway</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#scripts-health-server"><code class="docutils literal notranslate"><span class="pre">scripts.health_server</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#scripts-key-mgmt"><code class="docutils literal notranslate"><span class="pre">scripts.key_mgmt</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#tests-init"><code class="docutils literal notranslate"><span class="pre">tests.__init__</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#tests-conftest"><code class="docutils literal notranslate"><span class="pre">tests.conftest</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#tests-test-auth"><code class="docutils literal notranslate"><span class="pre">tests.test_auth</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#tests-test-gateway"><code class="docutils literal notranslate"><span class="pre">tests.test_gateway</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/ARCHITECTURE_AUTO.html#tests-test-key-mgmt"><code class="docutils literal notranslate"><span class="pre">tests.test_key_mgmt</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto/REPO_MAP.html">Repository Structure</a><ul>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#directory-tree">Directory Tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#key-files">Key Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/REPO_MAP.html#entry-points">Entry Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/REPO_MAP.html#important-files">Important Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#configuration-files">Configuration Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/REPO_MAP.html#scripts">Scripts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html">Workflow Registry &amp; Tool Coverage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#how-to-use-this-document">How to Use This Document</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#pre-commit-vs-ci-how-they-work-together">Pre-commit vs. CI: How They Work Together</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#why-the-overlap-matters">Why the overlap matters</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#tools-unique-to-each-context">Tools unique to each context</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#workflow-registry">Workflow Registry</a></li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#tool-coverage-matrix">Tool Coverage Matrix</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#version-comparison-tools-in-both-ci-and-pre-commit">Version Comparison (tools in both CI and pre-commit)</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#scope-differences-between-ci-and-pre-commit">Scope Differences Between CI and Pre-commit</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#blocking-vs-advisory-behavior">Blocking vs. Advisory Behavior</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#blocking-will-fail-your-pr">Blocking (will fail your PR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#advisory-warnings-only-will-not-fail">Advisory (warnings only, will not fail)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#recommended-adoption-profiles">Recommended Adoption Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#python-project-minimal">Python Project (Minimal)</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#python-project-comprehensive">Python Project (Comprehensive)</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#shell-project">Shell Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#python-docker-project">Python + Docker Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#full-stack-all-workflows">Full Stack (All Workflows)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto/WORKFLOW_REGISTRY.html#workflow-version-defaults">Workflow Version Defaults</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">llama-gguf-inference</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Security Audit Report — llama-gguf-inference v1</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/SECURITY_AUDIT.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="security-audit-report-llama-gguf-inference-v1">
<h1>Security Audit Report — llama-gguf-inference v1<a class="headerlink" href="#security-audit-report-llama-gguf-inference-v1" title="Link to this heading"></a></h1>
<p><strong>Audit Date:</strong> 2026-02-13 <strong>Auditor:</strong> SECURITY-ENGINEER <strong>Scope:</strong> Full code-level security audit of all endpoints and
container configuration for v1 release gate. <strong>Phase:</strong> Phase 4 — v1 Release Gate</p>
<hr class="docutils" />
<section id="audit-scope">
<h2>Audit Scope<a class="headerlink" href="#audit-scope" title="Link to this heading"></a></h2>
<p>The following files were reviewed line-by-line:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>File</p></th>
<th class="head"><p>LOC</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code></p></td>
<td><p>888</p></td>
<td><p>HTTP gateway, proxy logic, streaming, CORS, metrics, queuing</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">scripts/auth.py</span></code></p></td>
<td><p>385</p></td>
<td><p>API key validation, rate limiting, access logging</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">scripts/health_server.py</span></code></p></td>
<td><p>52</p></td>
<td><p>Health check server on port 8001</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">scripts/start.sh</span></code></p></td>
<td><p>~800</p></td>
<td><p>Startup orchestration, backend key generation, env var handling</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">scripts/key_mgmt.py</span></code></p></td>
<td><p>367</p></td>
<td><p>API key management CLI (generate, list, remove, rotate)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code></p></td>
<td><p>73</p></td>
<td><p>CUDA container image definition</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">Dockerfile.cpu</span></code></p></td>
<td><p>85</p></td>
<td><p>CPU multi-arch container image definition</p></td>
</tr>
</tbody>
</table>
<section id="checklist-areas">
<h3>Checklist Areas<a class="headerlink" href="#checklist-areas" title="Link to this heading"></a></h3>
<p>For each file, the following categories were evaluated:</p>
<ul class="simple">
<li><p>Input validation (all external inputs sanitized)</p></li>
<li><p>Authentication bypass possibilities</p></li>
<li><p>Injection vulnerabilities (command injection, header injection)</p></li>
<li><p>Information disclosure (error messages, logs, stack traces)</p></li>
<li><p>Resource exhaustion (memory, CPU, connections, file descriptors)</p></li>
<li><p>Race conditions (concurrent access, TOCTOU)</p></li>
<li><p>Secrets handling (no secrets in logs, proper generation, secure comparison)</p></li>
<li><p>Error handling (fail-closed, no sensitive data in error responses)</p></li>
<li><p>Container security (permissions, exposed ports, capabilities)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="previously-fixed-issues-verified">
<h2>Previously Fixed Issues (Verified)<a class="headerlink" href="#previously-fixed-issues-verified" title="Link to this heading"></a></h2>
<p>These issues were identified in prior audits and have been verified as correctly resolved.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>ID</p></th>
<th class="head"><p>Severity</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>File</p></th>
<th class="head"><p>Status</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>SEC-01</p></td>
<td><p>HIGH</p></td>
<td><p>Timing attack on API key comparison — dictionary lookup leaked timing information about valid keys</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/auth.py</span></code> L221-233</p></td>
<td><p><strong>VERIFIED FIXED</strong> — Uses <code class="docutils literal notranslate"><span class="pre">hmac.compare_digest()</span></code> for constant-time comparison. Iterates all keys without early return.</p></td>
</tr>
<tr class="row-odd"><td><p>SEC-02</p></td>
<td><p>HIGH</p></td>
<td><p>Fail-open on key file read error — exception during key loading allowed all requests through</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/auth.py</span></code> L77-154</p></td>
<td><p><strong>VERIFIED FIXED</strong> — Returns empty dict on error, which triggers fail-closed behavior (line 173: “no API keys loaded” rejects all).</p></td>
</tr>
<tr class="row-even"><td><p>SEC-03</p></td>
<td><p>HIGH</p></td>
<td><p>No request body size limit — attacker could send unbounded body to exhaust memory</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code> L80, L777</p></td>
<td><p><strong>VERIFIED FIXED</strong> — <code class="docutils literal notranslate"><span class="pre">MAX_REQUEST_BODY_SIZE</span></code> enforced before reading body. Returns 413 with proper error format.</p></td>
</tr>
<tr class="row-odd"><td><p>SEC-04</p></td>
<td><p>MEDIUM</p></td>
<td><p>CORS origin validation gaps — trailing slashes, oversized origins, missing scheme warnings</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code> L84-156</p></td>
<td><p><strong>VERIFIED FIXED</strong> — Trailing slash stripped, <code class="docutils literal notranslate"><span class="pre">MAX_ORIGIN_LENGTH</span></code> enforced, startup warnings for missing schemes, <code class="docutils literal notranslate"><span class="pre">Vary:</span> <span class="pre">Origin</span></code> in allowlist mode.</p></td>
</tr>
<tr class="row-even"><td><p>SEC-05</p></td>
<td><p>MEDIUM</p></td>
<td><p>No header count/size limits — attacker could send many/large headers to exhaust memory</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code> L81-82, L696-736</p></td>
<td><p><strong>VERIFIED FIXED</strong> — <code class="docutils literal notranslate"><span class="pre">MAX_HEADERS</span></code> (64) and <code class="docutils literal notranslate"><span class="pre">MAX_HEADER_LINE_SIZE</span></code> (8192) enforced per-header. Returns 431.</p></td>
</tr>
</tbody>
</table>
</section>
<hr class="docutils" />
<section id="new-findings">
<h2>New Findings<a class="headerlink" href="#new-findings" title="Link to this heading"></a></h2>
<section id="sec-06-high-instance-id-used-before-definition-sanitization-in-start-sh">
<h3>SEC-06 [HIGH] — INSTANCE_ID used before definition/sanitization in start.sh<a class="headerlink" href="#sec-06-high-instance-id-used-before-definition-sanitization-in-start-sh" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>HIGH</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/start.sh</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>196 (use) vs 234 (definition)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code> variable was used in the backend key file path
(<code class="docutils literal notranslate"><span class="pre">BACKEND_KEY_FILE=&quot;$BACKEND_KEY_DIR/backend-${INSTANCE_ID}.key&quot;</span></code>) on line 196 before it was defined and sanitized on
lines 234-235. If <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code> was set via an external environment variable containing path traversal characters (e.g.,
<code class="docutils literal notranslate"><span class="pre">../../etc/cron.d/malicious</span></code>), the unsanitized value would be used directly in the file path where the backend API key
is written. This could allow an attacker with control over the environment to write the key file to an arbitrary path.</p>
<p><strong>Impact:</strong> Path traversal in backend key file creation. An attacker controlling the <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code> environment variable
could write the backend API key to an arbitrary filesystem location.</p>
<p><strong>Fix Applied:</strong> Moved the <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code> definition and sanitization (<code class="docutils literal notranslate"><span class="pre">${INSTANCE_ID//[^a-zA-Z0-9._-]/_}</span></code>) to before the
backend key file path construction. INSTANCE_ID is now defined on line 183 and sanitized on line 184, before its first
use on line 200.</p>
</section>
<hr class="docutils" />
<section id="sec-07-medium-no-request-line-length-limit">
<h3>SEC-07 [MEDIUM] — No request line length limit<a class="headerlink" href="#sec-07-medium-no-request-line-length-limit" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>MEDIUM</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Line</strong></p></td>
<td><p>758</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The HTTP request line (e.g., <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/path</span> <span class="pre">HTTP/1.1</span></code>) is read via <code class="docutils literal notranslate"><span class="pre">asyncio.StreamReader.readline()</span></code>
without an explicit length limit. While <code class="docutils literal notranslate"><span class="pre">asyncio.StreamReader</span></code> has a default internal buffer limit of 64KB (<code class="docutils literal notranslate"><span class="pre">2**16</span></code>),
which provides an implicit ceiling, this is not explicitly controlled by the application. A malicious client could send
a very long request line (up to 64KB) consuming memory per-connection.</p>
<p><strong>Recommendation:</strong> Consider setting a <code class="docutils literal notranslate"><span class="pre">limit</span></code> parameter on <code class="docutils literal notranslate"><span class="pre">asyncio.start_server()</span></code> or adding an explicit request line
length check similar to the header line size check (SEC-05). Not urgent for v1 since asyncio’s default buffer provides a
reasonable cap.</p>
<p><strong>Fix Applied:</strong> Added <code class="docutils literal notranslate"><span class="pre">MAX_REQUEST_LINE_SIZE</span></code> constant (default 8192 bytes) with an explicit length check on the
request line after reading. Returns 414 URI Too Long if the request line exceeds the limit.</p>
</section>
<hr class="docutils" />
<section id="sec-08-medium-container-runs-as-root">
<h3>SEC-08 [MEDIUM] — Container runs as root<a class="headerlink" href="#sec-08-medium-container-runs-as-root" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>MEDIUM</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">Dockerfile</span></code>, <code class="docutils literal notranslate"><span class="pre">Dockerfile.cpu</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>All</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> Neither Dockerfile defines a non-root <code class="docutils literal notranslate"><span class="pre">USER</span></code> directive. All container processes (llama-server, gateway,
health server) run as root. If an attacker achieves code execution through a vulnerability in llama-server or the
gateway, they have full root privileges inside the container.</p>
<p><strong>Mitigating factors:</strong></p>
<ul class="simple">
<li><p>The base image (<code class="docutils literal notranslate"><span class="pre">ghcr.io/ggml-org/llama.cpp:server-cuda</span></code>) may require root for NVIDIA GPU device access</p></li>
<li><p>Container isolation provides a boundary regardless of internal user</p></li>
<li><p>No external package installation at runtime reduces the attack surface</p></li>
</ul>
<p><strong>Recommendation:</strong> For a future hardening pass, investigate running as a non-root user. This may require changes to the
base image or device permission configuration for GPU access. Document the rationale for running as root in the
Dockerfiles.</p>
<p><strong>Fix Applied:</strong> Added a non-root <code class="docutils literal notranslate"><span class="pre">inference</span></code> user (UID 1000) to both Dockerfiles. The CUDA image includes <code class="docutils literal notranslate"><span class="pre">video</span></code> group
membership for GPU device access. The CPU image has no GPU groups. Pre-created <code class="docutils literal notranslate"><span class="pre">/data</span></code> directories with correct
ownership so the non-root user can write model data and keys. All container processes now run as the <code class="docutils literal notranslate"><span class="pre">inference</span></code> user.</p>
</section>
<hr class="docutils" />
<section id="sec-09-medium-rate-limiter-state-not-bounded">
<h3>SEC-09 [MEDIUM] — Rate limiter state not bounded<a class="headerlink" href="#sec-09-medium-rate-limiter-state-not-bounded" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>MEDIUM</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/auth.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>65, 235-255</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The rate limiter uses <code class="docutils literal notranslate"><span class="pre">defaultdict(list)</span></code> mapping <code class="docutils literal notranslate"><span class="pre">key_id</span> <span class="pre">-&gt;</span> <span class="pre">[timestamps]</span></code>. While old timestamps are
pruned on each check, the pruning only occurs for the specific <code class="docutils literal notranslate"><span class="pre">key_id</span></code> being checked. If many distinct key_ids
accumulate entries (e.g., through many different valid API keys), stale entries for inactive keys are never cleaned up.
Additionally, if a single key makes many requests in rapid succession beyond the rate limit, the timestamp list grows
until the next check call prunes it.</p>
<p><strong>Impact:</strong> Gradual memory growth over long-running instances with many active API keys. In practice, the impact is
limited since each timestamp is only 8 bytes and keys are validated (16-128 chars), so realistic key counts are bounded.</p>
<p><strong>Recommendation:</strong> Add periodic background cleanup of stale rate limiter entries (e.g., every 5 minutes, remove all
key_ids with no recent timestamps). Not blocking for v1 but should be addressed for long-running production deployments.</p>
<p><strong>Fix Applied:</strong> Added lazy cleanup in <code class="docutils literal notranslate"><span class="pre">_check_rate_limit()</span></code> that runs every 5 minutes (<code class="docutils literal notranslate"><span class="pre">CLEANUP_INTERVAL</span> <span class="pre">=</span> <span class="pre">300</span></code>). On
each cleanup pass, all key_ids with no recent timestamps (outside the current rate limit window) are removed from the
rate limiter dictionary, preventing unbounded memory growth over long-running instances.</p>
</section>
<hr class="docutils" />
<section id="sec-10-low-content-length-parsing-lacks-error-handling">
<h3>SEC-10 [LOW] — Content-Length parsing lacks error handling<a class="headerlink" href="#sec-10-low-content-length-parsing-lacks-error-handling" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>LOW</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Line</strong></p></td>
<td><p>734</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The <code class="docutils literal notranslate"><span class="pre">Content-Length</span></code> header value is parsed with <code class="docutils literal notranslate"><span class="pre">int(value.strip())</span></code> without a try/except for
<code class="docutils literal notranslate"><span class="pre">ValueError</span></code>. If a client sends a malformed Content-Length (e.g., <code class="docutils literal notranslate"><span class="pre">Content-Length:</span> <span class="pre">abc</span></code>), the exception propagates to
the outer handler in <code class="docutils literal notranslate"><span class="pre">handle_client</span></code>, which catches it generically and closes the connection silently. The client
receives no HTTP error response.</p>
<p><strong>Recommendation:</strong> Wrap <code class="docutils literal notranslate"><span class="pre">int()</span></code> in a try/except and return a 400 Bad Request response for malformed Content-Length
values.</p>
<p><strong>Fix Applied:</strong> Wrapped the <code class="docutils literal notranslate"><span class="pre">int()</span></code> call in a try/except <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> block. On malformed Content-Length values, the
gateway now returns a 400 Bad Request response using the <code class="docutils literal notranslate"><span class="pre">send_bad_request()</span></code> helper, giving the client a clear error
instead of a silent connection close.</p>
</section>
<hr class="docutils" />
<section id="sec-11-low-log-injection-via-request-path-and-method">
<h3>SEC-11 [LOW] — Log injection via request path and method<a class="headerlink" href="#sec-11-low-log-injection-via-request-path-and-method" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>LOW</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/auth.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>374</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The <code class="docutils literal notranslate"><span class="pre">log_access()</span></code> function writes <code class="docutils literal notranslate"><span class="pre">method</span></code> and <code class="docutils literal notranslate"><span class="pre">path</span></code> directly into the access log file without
sanitization. A malicious client could craft a request line containing newlines or pipe characters to inject fake log
entries (e.g., <code class="docutils literal notranslate"><span class="pre">GET</span> <span class="pre">/path\n2026-01-01T00:00:00</span> <span class="pre">|</span> <span class="pre">admin</span> <span class="pre">|</span> <span class="pre">DELETE</span> <span class="pre">/keys</span> <span class="pre">|</span> <span class="pre">200</span></code>). While the HTTP request line is decoded
with <code class="docutils literal notranslate"><span class="pre">errors=&quot;replace&quot;</span></code> in the gateway (which replaces invalid bytes), valid UTF-8 newline characters in the request
line would pass through.</p>
<p><strong>Mitigating factors:</strong> The access log is an internal audit file, not user-facing. Exploitation requires a valid API key
(authenticated endpoint). The <code class="docutils literal notranslate"><span class="pre">readline()</span></code> call in the gateway naturally splits on <code class="docutils literal notranslate"><span class="pre">\n</span></code>, so injecting newlines in the
request line would require the raw bytes to contain <code class="docutils literal notranslate"><span class="pre">\r\n</span></code> followed by more data, which <code class="docutils literal notranslate"><span class="pre">readline()</span></code> would not include.</p>
<p><strong>Recommendation:</strong> Sanitize <code class="docutils literal notranslate"><span class="pre">method</span></code> and <code class="docutils literal notranslate"><span class="pre">path</span></code> in <code class="docutils literal notranslate"><span class="pre">log_access()</span></code> by replacing control characters (e.g., <code class="docutils literal notranslate"><span class="pre">\n</span></code>, <code class="docutils literal notranslate"><span class="pre">\r</span></code>,
<code class="docutils literal notranslate"><span class="pre">|</span></code>) before writing.</p>
<p><strong>Fix Applied:</strong> Added <code class="docutils literal notranslate"><span class="pre">_sanitize_log_field()</span></code> helper in <code class="docutils literal notranslate"><span class="pre">auth.py</span></code> that replaces <code class="docutils literal notranslate"><span class="pre">\n</span></code>, <code class="docutils literal notranslate"><span class="pre">\r</span></code>, <code class="docutils literal notranslate"><span class="pre">\t</span></code>, and <code class="docutils literal notranslate"><span class="pre">|</span></code> characters
with underscores. Applied to <code class="docutils literal notranslate"><span class="pre">method</span></code>, <code class="docutils literal notranslate"><span class="pre">path</span></code>, and <code class="docutils literal notranslate"><span class="pre">key_id</span></code> fields in <code class="docutils literal notranslate"><span class="pre">log_access()</span></code> before writing to the access log.</p>
</section>
<hr class="docutils" />
<section id="sec-12-low-health-endpoint-exposes-internal-metrics-to-unauthenticated-clients">
<h3>SEC-12 [LOW] — Health endpoint exposes internal metrics to unauthenticated clients<a class="headerlink" href="#sec-12-low-health-endpoint-exposes-internal-metrics-to-unauthenticated-clients" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>LOW</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>335-370, 381-417</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The <code class="docutils literal notranslate"><span class="pre">/health</span></code> and <code class="docutils literal notranslate"><span class="pre">/metrics</span></code> endpoints are unauthenticated and expose operational details including:</p>
<ul class="simple">
<li><p>Request counts, error rates, active connections</p></li>
<li><p>Queue depth and configuration (max_concurrent, max_queue_size)</p></li>
<li><p>Gateway uptime</p></li>
<li><p>Whether authentication is enabled</p></li>
<li><p>Backend health status</p></li>
</ul>
<p>This information could help an attacker understand system load patterns, timing, and configuration.</p>
<p><strong>Mitigating factors:</strong> This is a common pattern for infrastructure endpoints. The endpoints deliberately exclude
sensitive per-key metrics. The information is operational, not credential-related.</p>
<p><strong>Recommendation:</strong> Consider making <code class="docutils literal notranslate"><span class="pre">/metrics</span></code> optionally authenticated via a configuration flag for deployments where
metric exposure is a concern. The current behavior is acceptable for v1 since operational monitoring is a primary use
case.</p>
<p><strong>Fix Applied:</strong> Added <code class="docutils literal notranslate"><span class="pre">METRICS_AUTH_ENABLED</span></code> environment variable (default <code class="docutils literal notranslate"><span class="pre">false</span></code>). When set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, the <code class="docutils literal notranslate"><span class="pre">/metrics</span></code>
endpoint requires authentication (same as API endpoints). The <code class="docutils literal notranslate"><span class="pre">/ping</span></code> and <code class="docutils literal notranslate"><span class="pre">/health</span></code> endpoints remain public to support
platform health checks and scale-to-zero behavior.</p>
</section>
<hr class="docutils" />
<section id="sec-13-low-backend-response-headers-forwarded-without-size-limit">
<h3>SEC-13 [LOW] — Backend response headers forwarded without size limit<a class="headerlink" href="#sec-13-low-backend-response-headers-forwarded-without-size-limit" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>LOW</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/gateway.py</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>725-752</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> When proxying responses from the backend, response headers are accumulated in memory without a size
limit (<code class="docutils literal notranslate"><span class="pre">response_headers</span> <span class="pre">+=</span> <span class="pre">line</span></code> in a loop). A compromised or malicious backend could send very large response headers
to exhaust gateway memory.</p>
<p><strong>Mitigating factors:</strong> The backend is llama-server running on localhost, controlled by the same operator. The
<code class="docutils literal notranslate"><span class="pre">readline()</span></code> timeout prevents indefinite hanging. This would only be exploitable if the backend itself were compromised.</p>
<p><strong>Fix Applied:</strong> Added <code class="docutils literal notranslate"><span class="pre">MAX_RESPONSE_HEADER_SIZE</span></code> constant (65536 = 64KB) enforced in the response header accumulation
loop in <code class="docutils literal notranslate"><span class="pre">proxy_request()</span></code>. When the cumulative size exceeds the limit, the backend connection is closed and a 502 Bad
Gateway response is returned to the client. This is a defense-in-depth measure; the limit is not configurable via
environment variable since operators should not need to change it.</p>
</section>
<hr class="docutils" />
<section id="sec-14-info-extra-args-word-split-without-validation">
<h3>SEC-14 [INFO] — EXTRA_ARGS word-split without validation<a class="headerlink" href="#sec-14-info-extra-args-word-split-without-validation" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>INFO</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/start.sh</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Line</strong></p></td>
<td><p>494</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The <code class="docutils literal notranslate"><span class="pre">EXTRA_ARGS</span></code> environment variable is word-split and appended to the llama-server command arguments
without validation. This is intentional (shellcheck disable comment present) and allows operators to pass additional
flags. However, there is no documentation warning that this could override security-critical arguments (e.g.,
<code class="docutils literal notranslate"><span class="pre">--host</span> <span class="pre">0.0.0.0</span></code> to rebind llama-server to all interfaces, bypassing the localhost-only restriction).</p>
<p><strong>Recommendation:</strong> Add a comment and documentation note warning operators that <code class="docutils literal notranslate"><span class="pre">EXTRA_ARGS</span></code> can override security
defaults, and consider a blocklist of dangerous overrides (e.g., <code class="docutils literal notranslate"><span class="pre">--host</span></code>).</p>
<p><strong>Fix Applied:</strong> Added a startup warning when <code class="docutils literal notranslate"><span class="pre">EXTRA_ARGS</span></code> is non-empty, logging the actual value to alert operators
that custom arguments are being passed to llama-server. This makes the use of <code class="docutils literal notranslate"><span class="pre">EXTRA_ARGS</span></code> visible in container logs for
audit and debugging purposes.</p>
</section>
<hr class="docutils" />
<section id="sec-15-info-debug-shell-mode-exposes-full-environment">
<h3>SEC-15 [INFO] — DEBUG_SHELL mode exposes full environment<a class="headerlink" href="#sec-15-info-debug-shell-mode-exposes-full-environment" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>INFO</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/start.sh</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Lines</strong></p></td>
<td><p>253-261</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> When <code class="docutils literal notranslate"><span class="pre">DEBUG_SHELL=true</span></code>, the script logs the complete environment (<code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">|</span> <span class="pre">sort</span></code>), which includes
<code class="docutils literal notranslate"><span class="pre">BACKEND_API_KEY</span></code> and any other sensitive environment variables. This is intended for debugging only but could
inadvertently expose secrets if container logs are captured or forwarded to a logging service.</p>
<p><strong>Mitigating factors:</strong> Requires explicit opt-in via <code class="docutils literal notranslate"><span class="pre">DEBUG_SHELL=true</span></code>. Only outputs to container stdout/stderr. The
backend key is generated per-session and would be invalidated on next restart.</p>
<p><strong>Recommendation:</strong> Filter sensitive variables from the <code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">|</span> <span class="pre">sort</span></code> output (e.g., exclude <code class="docutils literal notranslate"><span class="pre">*KEY*</span></code>, <code class="docutils literal notranslate"><span class="pre">*SECRET*</span></code>,
<code class="docutils literal notranslate"><span class="pre">*TOKEN*</span></code>, <code class="docutils literal notranslate"><span class="pre">*PASSWORD*</span></code>).</p>
<p><strong>Fix Applied:</strong> Changed the debug environment dump from <code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">|</span> <span class="pre">sort</span></code> to
<code class="docutils literal notranslate"><span class="pre">env</span> <span class="pre">|</span> <span class="pre">sort</span> <span class="pre">|</span> <span class="pre">grep</span> <span class="pre">-viE</span> <span class="pre">'(key|secret|token|password|credential)'</span></code> to filter out any environment variables whose names
contain sensitive keywords. This prevents accidental disclosure of secrets in debug output while still providing useful
diagnostic information.</p>
</section>
<hr class="docutils" />
<section id="sec-16-info-backend-key-partial-disclosure-in-startup-log">
<h3>SEC-16 [INFO] — Backend key partial disclosure in startup log<a class="headerlink" href="#sec-16-info-backend-key-partial-disclosure-in-startup-log" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Field</p></th>
<th class="head"><p>Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Severity</strong></p></td>
<td><p>INFO</p></td>
</tr>
<tr class="row-odd"><td><p><strong>File</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">scripts/start.sh</span></code></p></td>
</tr>
<tr class="row-even"><td><p><strong>Line</strong></p></td>
<td><p>306</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Status</strong></p></td>
<td><p><strong>FIXED</strong></p></td>
</tr>
</tbody>
</table>
<p><strong>Description:</strong> The startup log prints the first 8 and last 8 characters of the backend API key:
<code class="docutils literal notranslate"><span class="pre">BACKEND_AUTH=enabled</span> <span class="pre">(key:</span> <span class="pre">${BACKEND_API_KEY:0:8}...${BACKEND_API_KEY:</span> <span class="pre">-8})</span></code>. While this is a truncated form useful for
debugging, revealing 16 of 51 characters (31%) reduces the brute-force search space.</p>
<p><strong>Mitigating factors:</strong> The backend key is only used for localhost communication between the gateway and llama-server.
An attacker with access to container logs cannot reach the backend directly (bound to 127.0.0.1). The key is per-session
and regenerated on restart.</p>
<p><strong>Recommendation:</strong> Reduce to showing only the first 8 characters (prefix only) for identification purposes.</p>
<p><strong>Fix Applied:</strong> Reduced the backend key disclosure from first 8 + last 8 characters (31% of the key) to first 8
characters only. The startup log now shows <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">${BACKEND_API_KEY:0:8}...</span></code> which is sufficient for identification while
minimizing information disclosure.</p>
</section>
</section>
<hr class="docutils" />
<section id="security-strengths">
<h2>Security Strengths<a class="headerlink" href="#security-strengths" title="Link to this heading"></a></h2>
<p>The codebase demonstrates strong security practices in several areas:</p>
<ol class="arabic simple">
<li><p><strong>Constant-time key comparison</strong> (SEC-01 fix): <code class="docutils literal notranslate"><span class="pre">hmac.compare_digest()</span></code> with full key iteration prevents timing
attacks.</p></li>
<li><p><strong>Fail-closed authentication</strong>: Missing keys file, empty keys, or load errors all result in rejecting all requests.</p></li>
<li><p><strong>Defense-in-depth with backend key</strong>: The auto-generated per-session backend key ensures that even if the gateway is
bypassed, llama-server requires authentication. The key is stored in <code class="docutils literal notranslate"><span class="pre">/dev/shm</span></code> (memory-backed, not persisted to
disk) with 600 permissions and securely deleted on shutdown.</p></li>
<li><p><strong>Request size limits</strong>: Body size (SEC-03), header count, and header line size (SEC-05) are all enforced before
reading data.</p></li>
<li><p><strong>Backend isolation</strong>: llama-server binds only to <code class="docutils literal notranslate"><span class="pre">127.0.0.1</span></code>, verified at startup via <code class="docutils literal notranslate"><span class="pre">netstat</span></code>/<code class="docutils literal notranslate"><span class="pre">ss</span></code>. This prevents
direct network access to the backend.</p></li>
<li><p><strong>CORS hardening</strong> (SEC-04): Origin validation with length limits, trailing slash normalization, and <code class="docutils literal notranslate"><span class="pre">Vary:</span> <span class="pre">Origin</span></code>
for caching correctness.</p></li>
<li><p><strong>Secure key generation</strong>: Both backend keys and API keys use <code class="docutils literal notranslate"><span class="pre">secrets.token_urlsafe()</span></code> (CSPRNG). API key management
uses atomic writes with proper file permissions.</p></li>
<li><p><strong>Graceful error handling</strong>: Error responses use OpenAI-compatible format without exposing internal details. Backend
errors return generic 502 without stack traces.</p></li>
<li><p><strong>Secure shutdown</strong>: Backend key files are securely deleted using <code class="docutils literal notranslate"><span class="pre">shred</span></code> (with fallback to zero-overwrite + <code class="docutils literal notranslate"><span class="pre">rm</span></code>).</p></li>
<li><p><strong>Input sanitization</strong>: <code class="docutils literal notranslate"><span class="pre">INSTANCE_ID</span></code>, <code class="docutils literal notranslate"><span class="pre">WORKER_TYPE</span></code>, and <code class="docutils literal notranslate"><span class="pre">LOG_NAME</span></code> are all sanitized via character class
substitution before use in file paths.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="findings-summary">
<h2>Findings Summary<a class="headerlink" href="#findings-summary" title="Link to this heading"></a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Severity</p></th>
<th class="head"><p>Count</p></th>
<th class="head"><p>Open</p></th>
<th class="head"><p>Fixed</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CRITICAL</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-odd"><td><p>HIGH</p></td>
<td><p>1</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-even"><td><p>MEDIUM</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>LOW</p></td>
<td><p>4</p></td>
<td><p>0</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p>INFO</p></td>
<td><p>3</p></td>
<td><p>0</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Total</strong></p></td>
<td><p><strong>11</strong></p></td>
<td><p><strong>0</strong></p></td>
<td><p><strong>11</strong></p></td>
</tr>
</tbody>
</table>
<p>Previously fixed (verified): 5 (SEC-01 through SEC-05)</p>
</section>
<hr class="docutils" />
<section id="v1-release-assessment">
<h2>v1 Release Assessment<a class="headerlink" href="#v1-release-assessment" title="Link to this heading"></a></h2>
<p><strong>Recommendation: APPROVE for v1 release.</strong></p>
<p><strong>Rationale:</strong></p>
<ul class="simple">
<li><p><strong>All 11 findings from this audit are now FIXED.</strong> Zero open findings across all severity levels.</p></li>
<li><p><strong>No open CRITICAL findings.</strong> The codebase has no vulnerabilities that could lead to unauthorized access, data
breach, or complete system compromise.</p></li>
<li><p><strong>No open HIGH findings.</strong> The one HIGH finding (SEC-06: INSTANCE_ID path traversal) was fixed during the audit.</p></li>
<li><p><strong>All MEDIUM findings have been resolved:</strong></p>
<ul>
<li><p>SEC-07 (request line length): Explicit <code class="docutils literal notranslate"><span class="pre">MAX_REQUEST_LINE_SIZE</span></code> check added with 414 response.</p></li>
<li><p>SEC-08 (root container): Non-root <code class="docutils literal notranslate"><span class="pre">inference</span></code> user added to both Dockerfiles with proper group memberships.</p></li>
<li><p>SEC-09 (rate limiter unbounded): Lazy cleanup every 5 minutes removes stale entries.</p></li>
</ul>
</li>
<li><p><strong>All LOW findings have been resolved:</strong></p>
<ul>
<li><p>SEC-10 (Content-Length parsing): Proper error handling with 400 Bad Request response.</p></li>
<li><p>SEC-11 (log injection): <code class="docutils literal notranslate"><span class="pre">_sanitize_log_field()</span></code> strips control characters from log entries.</p></li>
<li><p>SEC-12 (metrics auth): <code class="docutils literal notranslate"><span class="pre">METRICS_AUTH_ENABLED</span></code> flag allows operators to require auth on <code class="docutils literal notranslate"><span class="pre">/metrics</span></code>.</p></li>
<li><p>SEC-13 (backend response headers): <code class="docutils literal notranslate"><span class="pre">MAX_RESPONSE_HEADER_SIZE</span></code> enforced with 502 on overflow.</p></li>
</ul>
</li>
<li><p><strong>All INFO findings have been resolved:</strong></p>
<ul>
<li><p>SEC-14 (EXTRA_ARGS): Startup warning logged when non-empty.</p></li>
<li><p>SEC-15 (DEBUG_SHELL): Sensitive environment variables filtered from debug output.</p></li>
<li><p>SEC-16 (backend key disclosure): Reduced to first 8 characters only.</p></li>
</ul>
</li>
<li><p><strong>The security architecture is sound:</strong> Defense-in-depth (frontend auth + backend auth + localhost binding),
fail-closed defaults, constant-time comparisons, secure key lifecycle management, and proper input validation
throughout.</p></li>
</ul>
<p>All findings from this and prior audits (SEC-01 through SEC-16) have been resolved. The codebase exceeds the v1 release
gate requirement for security with zero open findings.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, llama-gguf-inference contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>